pipeline {
  agent any

    parameters {
    string(name: 'COMPONENT', defaultValue: '', description: 'Which Component you would like to release?')
    string(name: 'TAG', defaultValue: '', description: 'Release Number')
    password(name: 'TOKEN', defaultValue: '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', description: 'Token')
  }

  stages {

    stage('Create Tag') {
      steps {
        sh """
           git clone https://github.com:${TOKEN}/nareshreddy123/devopsnaresh.git/${COMPONENT}.git
          git tag ${TAG}
          git push --tags
        """
      }
    }

    stage('Trigger CI for release') {
      steps {
        build wait: false, job: "${COMPONENT}-ci", parameters: [string(name: 'TAG', value: "${TAG}")]
      }
    }

  }
post {
    always {
      cleanWs()
    }
  }

}
